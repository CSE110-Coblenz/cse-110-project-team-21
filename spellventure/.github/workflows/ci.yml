# ============================================
# GitHub Actions CI Pipeline for Spellventure
# ============================================
# This workflow runs automatically whenever:
#   - Someone pushes to any branch
#   - Someone opens or updates a PR into main
#
# Because our actual project lives inside /spellventure,
# we tell GitHub Actions to run npm commands IN THAT FOLDER.
#
# What this CI does:
#   1. Checks out the repo
#   2. Uses Node.js v18
#   3. Installs dependencies from spellventure/package.json
#   4. Runs ESLint
#   5. Builds with Vite (npm run build)
# ============================================

name: CI

on:
  push:
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest

    # All "run:" commands below will execute inside /spellventure
    defaults:
      run:
        working-directory: spellventure

    steps:
      # Step 1 — Checkout repo
      - name: Checkout repository
        uses: actions/checkout@v3

      # Step 2 — Install Node + use npm cache
      - name: Set up Node
        uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: "npm"
          cache-dependency-path: spellventure/package-lock.json

      # Step 3 — Install dependencies
      - name: Install dependencies
        run: npm ci

      # Step 4 — Run ESLint (fails pipeline if errors)
      - name: Run ESLint
        run: npm run lint

      # Step 5 — Build project (vite build)
      - name: Build project
        run: npm run build --if-present
